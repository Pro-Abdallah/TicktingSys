{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 244, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/hp/Downloads/ITTickting%20Sys/lib/db.ts"],"sourcesContent":["import mssql from 'mssql';\r\n\r\nconst config: any = {\r\n    server: process.env.DB_SERVER || 'DESKTOP-9M75GPK',\r\n    database: process.env.DB_NAME || 'ElsewedySchoolSysDB_DEV',\r\n    options: {\r\n        encrypt: process.env.DB_ENCRYPT === 'true',\r\n        trustServerCertificate: process.env.DB_TRUST_SERVER_CERTIFICATE === 'true',\r\n    },\r\n    pool: {\r\n        max: 10,\r\n        min: 0,\r\n        idleTimeoutMillis: 30000\r\n    }\r\n};\r\n\r\n// Use Integrated Security (Windows Authentication) if specified\r\nif (process.env.DB_INTEGRATED_SECURITY === 'true') {\r\n    config.options.trustedConnection = true;\r\n} else {\r\n    config.user = process.env.DB_USER;\r\n    config.password = process.env.DB_PASSWORD;\r\n}\r\n\r\n\r\nlet poolPromise: Promise<mssql.ConnectionPool> | null = null;\r\n\r\nexport async function getDbPool() {\r\n    if (poolPromise) return poolPromise;\r\n\r\n    poolPromise = mssql.connect(config as any);\r\n    return poolPromise;\r\n}\r\n\r\nexport async function query(sql: string, params: Record<string, any> = {}) {\r\n    const pool = await getDbPool();\r\n    const request = pool.request();\r\n\r\n    for (const [key, value] of Object.entries(params)) {\r\n        request.input(key, value);\r\n    }\r\n\r\n    return request.query(sql);\r\n}\r\n\r\nexport { mssql };\r\n"],"names":[],"mappings":";;;;;;AAAA;;AAEA,MAAM,SAAc;IAChB,QAAQ,QAAQ,GAAG,CAAC,SAAS,IAAI;IACjC,UAAU,QAAQ,GAAG,CAAC,OAAO,IAAI;IACjC,SAAS;QACL,SAAS,QAAQ,GAAG,CAAC,UAAU,KAAK;QACpC,wBAAwB,QAAQ,GAAG,CAAC,2BAA2B,KAAK;IACxE;IACA,MAAM;QACF,KAAK;QACL,KAAK;QACL,mBAAmB;IACvB;AACJ;AAEA,gEAAgE;AAChE,IAAI,QAAQ,GAAG,CAAC,sBAAsB,KAAK,QAAQ;IAC/C,OAAO,OAAO,CAAC,iBAAiB,GAAG;AACvC,OAAO;IACH,OAAO,IAAI,GAAG,QAAQ,GAAG,CAAC,OAAO;IACjC,OAAO,QAAQ,GAAG,QAAQ,GAAG,CAAC,WAAW;AAC7C;AAGA,IAAI,cAAoD;AAEjD,eAAe;IAClB,IAAI,aAAa,OAAO;IAExB,cAAc,8NAAK,CAAC,OAAO,CAAC;IAC5B,OAAO;AACX;AAEO,eAAe,MAAM,GAAW,EAAE,SAA8B,CAAC,CAAC;IACrE,MAAM,OAAO,MAAM;IACnB,MAAM,UAAU,KAAK,OAAO;IAE5B,KAAK,MAAM,CAAC,KAAK,MAAM,IAAI,OAAO,OAAO,CAAC,QAAS;QAC/C,QAAQ,KAAK,CAAC,KAAK;IACvB;IAEA,OAAO,QAAQ,KAAK,CAAC;AACzB"}},
    {"offset": {"line": 291, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/hp/Downloads/ITTickting%20Sys/app/api/test-db/route.ts"],"sourcesContent":["import { NextResponse } from 'next/server';\r\nimport { query } from '@/lib/db';\r\n\r\nexport async function GET() {\r\n    try {\r\n        // A simple query to check the connection\r\n        const result = await query('SELECT 1 as connected');\r\n        return NextResponse.json({\r\n            success: true,\r\n            message: 'Database connection successful',\r\n            data: result.recordset[0]\r\n        });\r\n    } catch (error: any) {\r\n        console.error('Database connection error:', error);\r\n        return NextResponse.json({\r\n            success: false,\r\n            message: 'Database connection failed',\r\n            error: error.message\r\n        }, { status: 500 });\r\n    }\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,eAAe;IAClB,IAAI;QACA,yCAAyC;QACzC,MAAM,SAAS,MAAM,IAAA,oKAAK,EAAC;QAC3B,OAAO,gTAAY,CAAC,IAAI,CAAC;YACrB,SAAS;YACT,SAAS;YACT,MAAM,OAAO,SAAS,CAAC,EAAE;QAC7B;IACJ,EAAE,OAAO,OAAY;QACjB,QAAQ,KAAK,CAAC,8BAA8B;QAC5C,OAAO,gTAAY,CAAC,IAAI,CAAC;YACrB,SAAS;YACT,SAAS;YACT,OAAO,MAAM,OAAO;QACxB,GAAG;YAAE,QAAQ;QAAI;IACrB;AACJ"}}]
}